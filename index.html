<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Web app</title>
    
</head>
<style>
    * {
        margin: 0;
        padding: 0;
        font-family: monospace;
        box-sizing: border-box;
        user-select: none;
    }

    .main {
        width: 100vw;
        background-color: #E3F2FD;
        height: 100vh;
    }

    .top {
        width: 100vw;
        height: 100px;
        display: grid;
        place-items: center;
        background-color: #5372F0;
        animation: down 0.3s;
    }

    @keyframes down {
        0% {
            transform: translateY(-50px);
        }

        100% {
            transform: translateY(0px);
        }
    }

    .top p {
        font-size: 40px;
        text-decoration: none;
        color: #ffffff;
        background-color: transparent;
        font-weight: 700;
    }

    .rightcont {
        width: 700px;
        height: 200px;
        background-color: #5372F0;
        margin-left: 45%;
        margin-top: 50px;
        animation: left 0.5s;
    }

    @keyframes left {
        0% {
            transform: translateX(8800px);
        }
    }

    .rightcont img {
        height: 100px;
        background-color: transparent;
        margin-left: 50px;
    }

    .rightcont .situ {
        background-color: transparent;
        font-weight: 700;
        color: white;
        font-size: 20px;
        margin-top: 10px;
        margin-left: 70px;
    }

    .nameandtemp p {
        color: white;
    }

    .nameandtemp {
        margin-left: 55%;

        margin-top: -120px;
    }

    .name {
        font-size: 40px;
        font-weight: 600;
    }

    .temp,
    .rain,
    .humidity {
        font-size: 30px;
    }

    .searchtab {

        margin-left: 70px;
        margin-top: -208px;
        animation: right 0.7s;
    }

    @keyframes right {
        0% {
            transform: translateX(-700px);
        }

        100% {
            transform: translateX(0px);
        }
    }

    .cname {
        font-size: 20px;
    }

    .searchtab label {
        font-weight: 700;
    }

    .searchtab input {
        margin-top: 20px;
        font-weight: 900;
        text-align: center;
        width: 250px;
        height: 40px;
        border-radius: 10px;
    }

    .searchtab .sbtn {
        width: 250px;
        height: 40px;
        margin-top: 17px;
        background-color: #5372F0;
        border: none;
        color: white;
        font-size: 19px;
        cursor: pointer;
    }

    .searchtab button:hover {
        transform: scaleY(1.1);
    }

    .or {
        margin-top: 15px;
        color: grey;
    }

    .cbtn {
        background-color: #6C757D;
        color: white;
        width: 250px;
        height: 40px;
        margin-top: 30px;
        font-size: 19px;
        cursor: pointer;
        border: none;
    }

    .cont {
        margin-left: 45%;
    }

    .cont li {
        list-style: none;
    }

    .df {
        font-size: 30px;
        animation: up 0.909s;
        font-weight: 900;
    }

    .card {
        display: flex;
        gap: 50px;
        
    }
    .c1{
        animation: up 0.909s;
    }
    .c2{
        animation: up 1.109s;
    }
    .c3{
        animation: up 1.209s;
    }
    .c1,
    .c2,
    .c3 {

        height: 160px;
        width: 200px;
        background-color: #6C757D;
    }

    li,
    img {
        margin-left: 30px;
        font-size: 20px;
        color: white;
    }

    @keyframes up {
        0% {
            transform: translateY(1000px);
        }

        100% {
            transform: translateY(0px);
        }
    }
    /* Your existing CSS code here */

/* Media queries for mobile devices */
@media (max-width: 768px) {
    body{
        overflow-x: hidden;
        background-color: #E3F2FD;
    }
    section{
        min-height: 100vh;
    }
    .top{
    text-align:center;
    }
  .rightcont {
    width: 90%;
    margin: 20px auto;
    padding: 20px;
    display: flex;
    font-size:20px;
    min-height: 40%;
    flex-direction: column;
    text-align: center;
    align-items: center;
  }

  .nameandtemp {
    margin-left: 0;
    margin-top: 10px;
    font-size: 20px;
    text-align: center;
  }

  .searchtab {
    display: grid;
    place-items: center;
    margin-top: 30px;
  }

  .cont {
    margin-left: 10%;
    background-color: #E3F2FD;
    display: grid;
    place-items: center;
  }

  .card {
    flex-direction: column;
    background-color: #E3F2FD;
    align-items: center;
  }
  .df{
    margin-left: 10px;
    margin-top: 70px;
    
  }

  .c1,
  .c2,
  .c3 {
    margin-bottom: 20px;
  }
}

</style>

<body>
    <section class="main" id="main">
        <div class="top">
            <p>Weather App By Abhay</p>
        </div>
        <div class="rightcont" id="rightcont">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAAdVJREFUaN7tmc1thDAQRimBElwCJVBCSvAxR5fgEiiBEiiBErhyIx24A2cc2WhiAf4ZA1rJkZ4UZZPN9/AwHrON1rr5ZJoqUAWqQBWoAlWgxJf++WaAAGZAAdpD2dfM7zDS/yopAGE6YDoIHMLIdK8KQIAWGIAtQ8Bh/r59bQWQjCBILCkSJIF1XVuAA9Jivm9ROd0ukS0AQTtgA7SH+Vn31EoEBSAMA2YUUAHiJDyWcCtBuidIArZEroJewVEpjQSJjiIgMsMbpHdjf53sCcEWSxEYCQKOyZQhkshZBZYkYEtHeLVPQSGJnHIS0QI2/FIo+L+VILTXOUVA3BD+D3Q/pAqoFIEebUxFQQLJN/Ojo0TEqDG/JgBv1hdgeVNAP4CKPSvkCKiCQc1KSMRs2+x902hO/Z4cYFhgWOQHY8zo9hOKgCCGH71BEXcqHjEBKDft5gowypVH4YeLgKE9ZSO10cxz7z7TFJqxOEUgZxyYbPi+0M4uSRuZPYCnCPBA6TwrYCWWyFbJImo/FTMpM6pAG5CYvDO0LDii7x2JNAtdSGxuQyp41Q87UqkHW8NJzYsbw+8d6Y5Hi+7qbw8IyOIPd9HRVD8qUD8fqAJVoApUgSrwqfwCJ6xaZshM+xMAAAAASUVORK5CYII="
                alt="">
            <p class="situ">Cloudy</p>
            <div class="nameandtemp">
                <p class="name" id="name">City</p>
                <p class="temp">Teperature: 32&deg;C</p>
                <p class="rain">Rain: 67%</p>
                <p class="humidity">Humidity: 84%</p>
            </div>

        </div>
        <div class="searchtab">
            <label class="cname" for="winp">Enter a City Name:</p>
                <input type="text" name="winp" id="winp" placeholder="Eg. New York, London, Tokyo"><br>
                <button class="sbtn" id="searchbtn">Search</button>
                <p class="or">_________ or _________</p>
                <button class="cbtn" onclick="getLocation()" id="myloc">Use Current Location</button>
        </div>
        <div class="cont">
            <p class="df">3 Days Forcast:</p>
            <div class="card">
                <div class="c1">
                    <img
                        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAAdVJREFUaN7tmc1thDAQRimBElwCJVBCSvAxR5fgEiiBEiiBErhyIx24A2cc2WhiAf4ZA1rJkZ4UZZPN9/AwHrON1rr5ZJoqUAWqQBWoAlWgxJf++WaAAGZAAdpD2dfM7zDS/yopAGE6YDoIHMLIdK8KQIAWGIAtQ8Bh/r59bQWQjCBILCkSJIF1XVuAA9Jivm9ROd0ukS0AQTtgA7SH+Vn31EoEBSAMA2YUUAHiJDyWcCtBuidIArZEroJewVEpjQSJjiIgMsMbpHdjf53sCcEWSxEYCQKOyZQhkshZBZYkYEtHeLVPQSGJnHIS0QI2/FIo+L+VILTXOUVA3BD+D3Q/pAqoFIEebUxFQQLJN/Ojo0TEqDG/JgBv1hdgeVNAP4CKPSvkCKiCQc1KSMRs2+x902hO/Z4cYFhgWOQHY8zo9hOKgCCGH71BEXcqHjEBKDft5gowypVH4YeLgKE9ZSO10cxz7z7TFJqxOEUgZxyYbPi+0M4uSRuZPYCnCPBA6TwrYCWWyFbJImo/FTMpM6pAG5CYvDO0LDii7x2JNAtdSGxuQyp41Q87UqkHW8NJzYsbw+8d6Y5Hi+7qbw8IyOIPd9HRVD8qUD8fqAJVoApUgSrwqfwCJ6xaZshM+xMAAAAASUVORK5CYII=">
                    <li>Date</li>
                    <li>Temp:</li>
                    <li>Rain:</li>
                    <li>Humidity:</li>
                </div>

                <div class="c2">
                    <img
                        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAAdVJREFUaN7tmc1thDAQRimBElwCJVBCSvAxR5fgEiiBEiiBErhyIx24A2cc2WhiAf4ZA1rJkZ4UZZPN9/AwHrON1rr5ZJoqUAWqQBWoAlWgxJf++WaAAGZAAdpD2dfM7zDS/yopAGE6YDoIHMLIdK8KQIAWGIAtQ8Bh/r59bQWQjCBILCkSJIF1XVuAA9Jivm9ROd0ukS0AQTtgA7SH+Vn31EoEBSAMA2YUUAHiJDyWcCtBuidIArZEroJewVEpjQSJjiIgMsMbpHdjf53sCcEWSxEYCQKOyZQhkshZBZYkYEtHeLVPQSGJnHIS0QI2/FIo+L+VILTXOUVA3BD+D3Q/pAqoFIEebUxFQQLJN/Ojo0TEqDG/JgBv1hdgeVNAP4CKPSvkCKiCQc1KSMRs2+x902hO/Z4cYFhgWOQHY8zo9hOKgCCGH71BEXcqHjEBKDft5gowypVH4YeLgKE9ZSO10cxz7z7TFJqxOEUgZxyYbPi+0M4uSRuZPYCnCPBA6TwrYCWWyFbJImo/FTMpM6pAG5CYvDO0LDii7x2JNAtdSGxuQyp41Q87UqkHW8NJzYsbw+8d6Y5Hi+7qbw8IyOIPd9HRVD8qUD8fqAJVoApUgSrwqfwCJ6xaZshM+xMAAAAASUVORK5CYII=">
                    <li>Date</li>
                    <li>Temp:</li>
                    <li>Rain:</li>
                    <li>Humidity:</li>
                </div>
                <div class="c3">
                    <img
                        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAAdVJREFUaN7tmc1thDAQRimBElwCJVBCSvAxR5fgEiiBEiiBErhyIx24A2cc2WhiAf4ZA1rJkZ4UZZPN9/AwHrON1rr5ZJoqUAWqQBWoAlWgxJf++WaAAGZAAdpD2dfM7zDS/yopAGE6YDoIHMLIdK8KQIAWGIAtQ8Bh/r59bQWQjCBILCkSJIF1XVuAA9Jivm9ROd0ukS0AQTtgA7SH+Vn31EoEBSAMA2YUUAHiJDyWcCtBuidIArZEroJewVEpjQSJjiIgMsMbpHdjf53sCcEWSxEYCQKOyZQhkshZBZYkYEtHeLVPQSGJnHIS0QI2/FIo+L+VILTXOUVA3BD+D3Q/pAqoFIEebUxFQQLJN/Ojo0TEqDG/JgBv1hdgeVNAP4CKPSvkCKiCQc1KSMRs2+x902hO/Z4cYFhgWOQHY8zo9hOKgCCGH71BEXcqHjEBKDft5gowypVH4YeLgKE9ZSO10cxz7z7TFJqxOEUgZxyYbPi+0M4uSRuZPYCnCPBA6TwrYCWWyFbJImo/FTMpM6pAG5CYvDO0LDii7x2JNAtdSGxuQyp41Q87UqkHW8NJzYsbw+8d6Y5Hi+7qbw8IyOIPd9HRVD8qUD8fqAJVoApUgSrwqfwCJ6xaZshM+xMAAAAASUVORK5CYII=">
                    <li>Date</li>
                    <li>Temp:</li>
                    <li>Rain:</li>
                    <li>Humidity:</li>
                </div>
            </div>
        </div>
        </div>
    </section>
    <script>
        const Loc = document.getElementById("name");
        const Temp = document.getElementsByClassName("temp");
        const geocodeApiUrl = "https://api.openweathermap.org/geo/1.0/reverse";
        const searchval = document.getElementById("winp");
        const Rain = document.getElementsByClassName("rain");
        const myloc = document.getElementById("myloc");
        
        const Hum = document.getElementsByClassName("humidity");
        const apikey = "863242cfb2b1d357e6093d9a4df19a4b";
        const apiurl = "https://api.openweathermap.org/data/2.5/weather?units=metric&q=";
        function checkWeather(city) {
            fetch(apiurl + city + `&appid=${apikey}`)
                .then((response) => response.json())
                .then((data) => {
                    console.log(data);
                    updateWeatherDisplay(data);
                })
                .catch((error) => {
                    console.error(error);
                });
                fetch(`https://api.openweathermap.org/data/2.5/forecast?units=metric&q=${city}&appid=${apikey}`)
            .then((response) => response.json())
            .then((data) => {
                updateForecastDisplay(data);
            })
            .catch((error) => {
                console.error(error);
            });
        }
        function updateForecastDisplay(data) {
        const forecastList = data.list;

        for (let i = 0; i < 3; i++) {
            const forecast = forecastList[i * 8]; // Get the forecast for the next 24 hours

            const date = new Date(forecast.dt * 1000);
            const dateElement = document.querySelectorAll(".c" + (i + 1) + " li")[0];
            dateElement.textContent = date.toLocaleDateString();

            const tempElement = document.querySelectorAll(".c" + (i + 1) + " li")[1];
            tempElement.textContent = "Temp: " + Math.round(forecast.main.temp) + "°C";

            const rainElement = document.querySelectorAll(".c" + (i + 1) + " li")[2];
            const rainPercentage = (forecast.rain && forecast.rain["3h"]) ? Math.min((forecast.rain["3h"] / 3) * 100, 100) : 0; // Ensure rain percentage doesn't go over 100%
            rainElement.textContent = "Rain: " + rainPercentage.toFixed(1) + "%";

            const humidityElement = document.querySelectorAll(".c" + (i + 1) + " li")[3];
            humidityElement.textContent = "Humidity: " + forecast.main.humidity + "%";
        }
    }

        function updateWeatherDisplay(data) {
            Loc.innerHTML = data.name;
            document.querySelector(".temp").innerHTML = Math.round(data.main.temp) + "°C";
            document.querySelector(".humidity").innerHTML = data.main.humidity + "% Humidity";
            document.querySelector(".rain").innerHTML = data.clouds.all + "% Rain";
            if (data.weather && data.weather.length > 0) {
                const weatherCondition = data.weather[0].main;
                if (weatherCondition === "Clouds") {
                    document.querySelector(".situ").innerHTML = "Cloudy";
                } else if (weatherCondition === "Rain" || weatherCondition === "Drizzle") {
                    document.querySelector(".situ").innerHTML = "Raining";
                } else {
                    document.querySelector(".situ").innerHTML = "Clear";
                }
            } else {
                document.querySelector(".situ").innerHTML = "Unknown";
            }
        }

        searchbtn.addEventListener("click", () => {
            checkWeather(searchval.value);
        });

        searchval.addEventListener("keypress", function (event) {
            if (event.key === "Enter") {
                event.preventDefault();
                searchbtn.click();
            }
        });
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition);
                console.log(showPosition)
            } else {
                locationDisplay.innerHTML = "Geolocation is not supported by this browser.";
            }
        }
        function formatTime(timestamp) {
            const date = new Date(timestamp * 1000);
            return date.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
        }
        function showPosition(position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;

            fetch(`${geocodeApiUrl}?lat=${latitude}&lon=${longitude}&limit=1&appid=${apikey}`)
                .then((response) => response.json())
                .then((data) => {
                    const city = data[0].name;
                    console.log(city)
                    Loc.innerHTML = city;
                    checkWeather(city);
                })
                .catch((error) => {
                    Loc.innerHTML = "Unable to retrieve location data.";
                    console.error(error);
                });
        }


        getLocation()
        function getLocation() {
        if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
        } else {
        alert("Geolocation is not supported by this browser.");
        }
        }
        
        function showPosition(position) {
        const latitude = position.coords.latitude;
        const longitude = position.coords.longitude;
        
        fetch(`https://api.openweathermap.org/geo/1.0/reverse?lat=${latitude}&lon=${longitude}&limit=1&appid=${apikey}`)
        .then((response) => response.json())
        .then((data) => {
        const city = data[0].name;
        document.getElementById("winp").value = city; // Set the input value to the detected city
        checkWeather(city);
        })
        .catch((error) => {
        console.error(error);
        });
        }
    </script>
</body>

</html>
